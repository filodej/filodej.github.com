--- 
name: wmu-6500fs-built-sw-git-1553
layout: post
time: 2008-06-09 09:31:00 +02:00
title: WMU-6500FS - GIT 1.5.5.3
---
<b>Build results:</b>
<a href="http://philodej.googlepages.com/git-1.5.5.3.tgz">[binary]</a>
<a href="http://philodej.googlepages.com/git-1.5.5.3.lst">[files list]</a>
<br/>
<br/>
<span class="fullpost">
<b>Build sequence:</b>
<pre class="code">
dev# wget <a href="http://kernel.org/pub/software/scm/git/git-1.5.5.3.tar.gz">http://kernel.org/pub/software/scm/git/git-1.5.5.3.tar.gz</a>
dev# tar xzvf git-1.5.5.3.tar.gz
dev# ./configure --prefix=/mnt/C/sys
dev# make
dev# make install
</pre>

<b>Deployment hack</b> <br/>
(touch some files in order to include them to the package)
<pre class="code">
dev# find /mnt/C/sys/share/ -path "*git*" -type f -exec touch {} \;
dev# find /mnt/C/sys/lib/ -path "*Git*" -type f -exec touch {} \;
</pre>

<b>Transfer Subversion DB to GIT</b><br/>
<b>Dependencies:</b>
<a href="http://filodej.blogspot.com/2008/06/wmu.html">subversion</a>
<br/>
<b>Info source:</b> 
<a href="http://utsl.gen.nz/talks/git-svn/intro.html#getting">[git-svn intro]</a>
<pre class="code">
box# svnserve -d -r /mnt/C/sys/var/svn/&lt;project&gt;
box# cd /mnt/C/sys/var/git/&lt;project&gt;
box# git svn init -t tags -b branches -T trunk svn://localhost/&lt;project&gt;
(or simply: box# git svn init svn://localhost/&lt;project&gt; )
box# git svn fetch
</pre>
<b>Error 1</b>
<pre class="code">
perl: Can't resolve symbol 'apr_initialize'
</pre>
can be replicated as follows:
<pre class="code">
box# perl -e "use SVN::Core"
</pre>
Inspect dependencies:
<pre class="code">
dev# ldd /mnt/C/sys/lib/perl5/site_perl/5.8.8/i386-linux-thread-multi/auto/SVN/_Core/_Core.so
...
libapr-1.so.0 => /mnt/C/sys/apache2/lib/libapr-1.so.0 (0x00000000)
...
dev# nm /mnt/C/sys/apache2/lib/libapr-1.so.0 | grep apr_initialize
00013c18 T apr_initialize
</pre>
Everything seem to be ok, maybe the libraries are loaded in a wrong order...
<pre class="code">
# export LD_PRELOAD=/mnt/C/sys/apache2/lib/libapr-1.so.0
</pre>

... error 1 fixed, but there is one more ...<br/>
<b>Error 2</b>
<pre class="code">
perl: Can't resolve symbol 'svn_swig_pl_get_current_pool'
</pre>
can be replicated as follows:
<pre class="code">
box# perl -e "use SVN::Wc; SVN::Wc::adm_open3(undef, '.', 0, 0);"
</pre>
Another pre-load needed:
<pre class="code">
box# export LD_PRELOAD=$LD_PRELOAD:/mnt/C/sys/lib/perl5/site_perl/5.8.8/i386-linux-thread-multi/auto/SVN/_Core/_Core.so
</pre>
Problem fixed - not saying that the fix is a proper solution, but I use the export only for repo conversion.
</span><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/183431720687819497-7210645857027432942?l=filodej.blogspot.com' alt='' /></div>
