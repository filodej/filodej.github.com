--- 
name: wmu-6500fs-box-with-jokers-fw
layout: post
time: 2008-06-09 08:13:00 +02:00
title: WMU-6500FS Configuration
---
<b>Info sources:</b>
<br/>
<a href="http://www.airlive.com/products/WMU-6500FS/wmu_6500fs.shtml">[WMU-6500FS product page]</a>
<br/>
<a href="http://airlive.com/support/WMU-6500FS/fd_wmu_6500fs.shtml">[Original firmware]</a>
<br/>
<a href="http://mgb111.pradnik.net/">[JoKeR's alternative firmware]</a>
<br/>
<a href="http://mgb111.pradnik.net/addons/">[JoKeR's pre-built software]</a>
<br/>
<a href="http://www.macsat.com/macsat/component/option,com_smf/Itemid,50/topic,690.0/">[Macsat forum]</a>
<br/>
<br/>
<b>Related info:</b>
<br/>
<a href="http://www.macsat.com/macsat/component/option,com_openwiki/Itemid,66/id,building_the_firmware/">[Howto build the firmware]</a>
<br/>
<a href="http://www.airlive.com/support/gpl_code/WMU6500FS_GPL_R400a9_20070904.tgz">[Original fw source]</a>
<br/>
<a href="http://www.airlive.com/support/gpl_code/GPL_toolChains_WMU-6000FS.zip">[WMU-6000 FS build toolchain]</a>
<br/>
<a href="http://www.uclibc.org/">[C library for embedded Linux systems]</a>
<br/>
<a href="http://cxx.uclibc.org/">[C++ standard library for embedded systems]</a>
<br/>
<br/>
<span class="fullpost">
<h3>Prerequisites</h3>
<ol>
<li><b>JoKeR's firmware:</b>
<a href="http://mgb111.pradnik.net/m-releases/C009-M/mgb111-update-400b4.c009m2.zip" >[FW C009-M Advanced]</a></li>
<li><b>First access</b> to device after the (successful) firmware upgrade:</li>
<br/>
... use a telnet client (e.g. Putty) to connect to the device:
<pre class="code">
box# cd /mnt/C
box# ls
</pre>
... there should be no <i>sys/</i> directory at the time
<pre class="code">
box# wget <a href="http://mgb111.pradnik.net/minimal-config.tar">http://mgb111.pradnik.net/minimal-config.tar</a>
box# tar xvf minimal-config.tar
</pre>
<li><b>Configuration</b></li>
Consider following settings in file <i>"/mnt/C/sys/etc/env-ng"</i>:
<pre class="code">
# include /etc/rc.nextgen to startup, if RCNG=0, 
# none of bottom options will work 
#(excluding CHBACKUP, NOTELNET, NOLOGIN!)
RCNG=1
# change root home dir from readonly flash to disk
ROOTDIR=1
# change root shell to bash (if exist)
ROOTSHELL=1
# change users shell to bash (if exist)
USERSHELL=1

# if 1 dropbear sshd will start (must exist, and configured!)
DROPBEAR=1

# if 1 then may use extra shell startup scripts 
# /mnt/C/sys/etc/rc.d/rc.* and different style /mnt/C/sys/etc/start.d/* 
# for links to executables.
RCPLUS=1

# if 1 then kernel module will be unloaded
NOWIFI=1
</pre>
... and creation of following files:<br/> 
<i>/mnt/C/sys/etc/rc.d/rc.kill</i>
<pre class="code">
### kill/remove unused#
killall -9 dhcpd amit_avs amit_tftpd amit_db 2>/dev/null &
route del -net 224.0.0.0 netmask 240.0.0.0 dev br0
</pre>
<i>/mnt/C/sys/etc/rc.d/rc.cfg</i>
<pre class="code">
### replace system configs
# hostname mgb111.host.net
# cat /mnt/C/sys/etc/smb.conf > /var/config/samba/smb.conf
# cat /mnt/C/sys/etc/resolv.conf > /etc/resolv.conf
# cat /mnt/C/sys/etc/hosts > /etc/hosts

# place user dirs at /home directory
sed -i 's|/tmp/Virtual/|/home/|g' /var/config/passwd
</pre>
<a name="x-config"></a>
<li><b>X client-server configuration</b></li>
We need an X server running and accessible for our X client applications. There are plenty of possible configurations, I use the <a href="http://en.wikipedia.org/wiki/Xming">XMing server</a>. For details see <a href="http://www.straightrunning.com/XmingNotes/">XMing notes</a> and <a href="http://gears.aset.psu.edu/hpc/guides/xming/">XMing intallation guide</a>.
<br/>
<br/>
<b>Download locations:</b>
<a href="http://mesh.dl.sourceforge.net/sourceforge/xming/Xming-mesa-6-9-0-31-setup.exe">[XMing mesa]</a> <a href="http://dfn.dl.sourceforge.net/sourceforge/xming/Xming-fonts-7-3-0-18-setup.exe">[XMing fonts]</a>
<br/>
Once we install and run the X server we have to configure X clients properly:
<pre class="code">
box# export DISPLAY=&lt;X-server-host-IP&gt;:0
</pre>
Now we can try to launch one:
<pre class="code">
box# /mnt/C/sys/X11/bin/xterm
Xlib: connection to "&lt;X-server-host-IP&gt;:0.0" refused by server
Xlib: No protocol specified
xterm Xt error: Can't open display: &lt;X-server-host-IP&gt;:0
</pre>
There is a configuration problem. When we look at the XMing log, we see:
<pre class="code">
AUDIT: ... Xming: client 4 rejected from IP &lt;X-server-host-IP&gt;
</pre>
As a quick solution, we can disable the access control:
<br/>
<i>Note: -ac is unsafe on public networks, but makes things easier for beginners on private ones.</i>
<pre class="code">
C:\Program Files\XMing\Xming.exe :0 -clipboard -multiwindow <b>-ac</b>
</pre>
... and problem is solved.
<br/>
<br/>
To make the <i>DISPLAY</i> and other X related settings permanent we have to add the following lines top the <i>/mnt/C/sys/etc/profile</i>:
<pre class="code">
# executable library and package paths (both X-based and console apps)
export PATH=$PATH:/mnt/C/sys/X11/bin/
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/mnt/C/sys/lib/:/mnt/C/sys/X11/lib/
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/mnt/C/sys/lib/pkgconfig/:/mnt/C/sys/X11/lib/pkgconfig/
# X server IP (for X-client apps)
export DISPLAY=&lt;X-server-host-IP&gt;:0
</pre>

<li><b>Soft & libs installation</b></li>
Essential and other libs and utils
<pre class="code">
box# cd /mnt/C
box# wget <a href="http://mgb111.pradnik.net/addons/libs-essential-20080502.tar.bz2">http://mgb111.pradnik.net/addons/libs-essential-20080502.tar.bz2</a>
box# tar xvjf libs-essential-20080502.tar.bz2
box# wget <a href="http://mgb111.pradnik.net/addons/util-linux.tar">http://mgb111.pradnik.net/addons/util-linux.tar</a>
box# tar xvf util-linux.tar
box# wget <a href="http://mgb111.pradnik.net/addons/soft-system/coreutils-5.96-2.tar.gz">http://mgb111.pradnik.net/addons/soft-system/coreutils-5.96-2.tar.gz</a>
box# tar xzvf coreutils-5.96-2.tar.gz
box# wget <a href="http://mgb111.pradnik.net/addons/nfs-utils.tar">http://mgb111.pradnik.net/addons/nfs-utils.tar</a>
box# tar xvf nfs-utils.tar
box# wget <a href="http://mgb111.pradnik.net/addons/busybox2-extended.tar.gz">http://mgb111.pradnik.net/addons/busybox2-extended.tar.gz</a>
box# tar xzvf busybox2-extended.tar.gz
box# wget <a href="http://mgb111.pradnik.net/addons/modules-kernel.tar">http://mgb111.pradnik.net/addons/modules-kernel.tar</a>
box# tar xvf modules-kernel.tar
box# wget <a href="http://mgb111.pradnik.net/addons/modules-kernel-extra.tar">http://mgb111.pradnik.net/addons/modules-kernel-extra.tar</a>
box# tar xvf modules-kernel-extra.tar
</pre>
SSL
<pre class="code">
box# cd /mnt/C
box# wget <a href="http://mgb111.pradnik.net/addons/openssl-0.9.tar">http://mgb111.pradnik.net/addons/openssl-0.9.tar</a>
box# tar xvf openssl-0.9.tar
</pre>
Bash
<pre class="code">
box# cd /mnt/C
box# wget <a href="http://mgb111.pradnik.net/addons/soft-shells/bash-3.2.33-3.tar.gz">http://mgb111.pradnik.net/addons/soft-shells/bash-3.2.33-3.tar.gz</a>
box# tar xzvf bash-3.2.33-3.tar.gz
</pre>
File viewers and editors
<pre class="code">
box# cd /mnt/C
box# wget <a href="http://mgb111.pradnik.net/addons/soft-system/less-381.tar">http://mgb111.pradnik.net/addons/soft-system/less-381.tar</a>
box# tar xvf less-381.tar
box# wget <a href="http://mgb111.pradnik.net/addons/soft-editors/nano-2.0.7-2.tar">http://mgb111.pradnik.net/addons/soft-editors/nano-2.0.7-2.tar</a>
box# tar xvf nano-2.0.7-2.tar
box# wget <a href="http://mgb111.pradnik.net/addons/soft-editors/zile-2.2.57.tar">http://mgb111.pradnik.net/addons/soft-editors/zile-2.2.57.tar</a>
box# tar xvf zile-2.2.57.tar
</pre>
Archivers/Unpackers
<pre class="code">
box# cd /mnt/C
box# wget <a href="http://mgb111.pradnik.net/addons/soft-archive-unpack/unzip-5.52.tar">http://mgb111.pradnik.net/addons/soft-archive-unpack/unzip-5.52.tar</a>
box# tar xvf unzip-5.52.tar
box# wget <a href="http://mgb111.pradnik.net/addons/soft-archive-unpack/rar-3.0.tar">http://mgb111.pradnik.net/addons/soft-archive-unpack/rar-3.0.tar</a>
box# tar xvf rar-3.0.tar
box# wget <a href="http://mgb111.pradnik.net/addons/soft-archive-unpack/p7zip_4.57.tar">http://mgb111.pradnik.net/addons/soft-archive-unpack/p7zip_4.57.tar</a>
box# tar xvf p7zip_4.57.tar
</pre>
Midnight commander
<pre class="code">
box# cd /mnt/C
box# wget <a href="http://mgb111.pradnik.net/addons/soft-file-managers/mc-20070623.tar.gz">http://mgb111.pradnik.net/addons/soft-file-managers/mc-20070623.tar.gz</a>
box# wget <a href="http://mgb111.pradnik.net/addons/mc-4.6.1.tar">http://mgb111.pradnik.net/addons/mc-4.6.1.tar</a>
box# tar xvf mc-4.6.1.tar
box# wget <a href="http://mgb111.pradnik.net/addons/mcedit.tar">http://mgb111.pradnik.net/addons/mcedit.tar</a>
box# tar xvf mcedit.tar
</pre>
AWK
<pre class="code">
box# cd /mnt/C
box# wget <a href="http://mgb111.pradnik.net/addons/soft-system/gawk-3.1.6.tar">http://mgb111.pradnik.net/addons/soft-system/gawk-3.1.6.tar</a>
box# tar xvf gawk-3.1.6.tar
</pre>
HDParm
<pre class="code">
box# cd /mnt/C
box# wget <a href="http://mgb111.pradnik.net/addons/soft-system/hdparm-8.6.tar">http://mgb111.pradnik.net/addons/soft-system/hdparm-8.6.tar</a>
box# tar xvf hdparm-8.6.tar
</pre>
SSH server/client (dropbear)<br/>
Info source: <a href="http://wiki.openwrt.org/DropbearPublicKeyAuthenticationHowto">[Public Key Authentication Howto]</a>
<pre class="code">
box# cd /mnt/C
box# wget <a href="http://mgb111.pradnik.net/addons/servers-ssh/dropbear-050.3-n-0.tgz">http://mgb111.pradnik.net/addons/servers-ssh/dropbear-050.3-n-0.tgz</a>
box# tar xvzf dropbear-050.3-n-0.tgz
box# dropbearkey -t rsa -f /mnt/C/sys/etc/dropbear_rsa_host_key
Will output 1024 bit rsa secret key to '/mnt/C/sys/etc/dropbear_rsa_host_key'
Generating key, this may take a while...
Public key portion is:
ssh-rsa AAAA... &lt;user&gt;@&lt;hostname&gt;
Fingerprint: md5 ... 
</pre>
... after reboot you can use SSH access (e.g. via Putty with SSH protocol) to connect to the device
</ol>

<h3>Communication with the box</h3>
As far as some communication channel can be established (e.g. via TCP/IP in this case) the fact that input/output devices are not present does not matter so much. There is a whole variety of ways how to communicate with such a device.
<br/>
<br/>
<u>For example following (mostly client/server) configurations are possible:</u>
<br/>
<i>(by building X.Org libraries I am just trying to enable the point 3 - I am interested mainly in X client part - not in server part - but do not know the exact dependencies and so I am building all)</i>

<ol>
<li> Web browser as a thin client connecting to a HTTP daemon running on the box (examples: built-in webUI, cvstrac, ...)</li>
<li> Telnet/SSH client running on separate machine and connecting to the box with running SSH daemon (example: dropbear + mc)</li>
<li> X-client application running on the box and connecting to X-server running elsewhere (e.g. on a PC). Box serves as an application server and X client, PC serves as X server and app client (examples: x applications)</li>
<li> <a href="http://www.vnc.com/vnc/index.html">VNC</a> viewer connecting to VNC server (along with X server) running on the box (examples: X applications) - not sure it this is possible with Airlive.</li>
<li> Some peripherals connected to the box (e.g. via USB). I tried to search the Web and have found some description <a href="http://www.linux-usb.org/USB-guide/x194.html">how to setup USB mouse and keyboard</a> and that there is a <a href="http://articles.directorym.net/Tritton_See2_USB_2_0_SVGA_Adapter_Review-a880404.html">USB2SVGA converter</a> and a guide <a href="http://howto.wikia.com/wiki/Howto_configure_the_Linux_kernel/drivers/usb/misc/sisusbvga">how to set it up</a>. I have no idea what the real possibilities are for the <i>Airlive</i> device and whether it is useful and practical but I think at least in principle it is possible.</li>
</ol>
</span><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/183431720687819497-6563339580716828730?l=filodej.blogspot.com' alt='' /></div>
