--- 
name: wmu-6500fs-build-environment
layout: post
time: 2008-06-09 08:32:00 +02:00
title: WMU-6500FS - Build environment
---
<ol>
<li>M$ Windows machine with running <a href="http://www.colinux.org/">CoLinux</a>/<a href="http://www.debian.org/">Debian</a> 4.0 installation (just minimal console setup, installing packages as needed) - in this document shell commands from this system are prefixed <b>deb#</b></li>
<li><a href="http://www.uclibc.org/">uClibc</a> development system - Prebuilt by JoKeR - download available <a href="http://mgb111.pradnik.net/addons/uclibc-basic.tar.bz2">[here]</a> (tried to build my own, but did not succeed even with JoKeR's config) stored on 'deb#' system and placed in chroot jail - shell commands from this system are prefixed <b>dev#</b></li>
<li><i>WMU-6500FS</i> box upgraded with JoKeR's firmware version <i>C009M Advanced</i>. Currently <a href="http://mgb111.pradnik.net/m-releases/C009-M/mgb111-update-400b4.c009m2.zip">there</a> is a newer version available - shell commands from this system are prefixed <b>box#</b></li>
</ol>
<span class="fullpost">
The initial preparation of the environment consists of following steps:
<ol>
<li>Download the archive with JoKeR's pre-built development system (assuming you want to extract it to your home directory):
<pre class="code">  
deb# cd ~
deb# wget <a href="http://mgb111.pradnik.net/addons/uclibc-basic.tar.bz2">http://mgb111.pradnik.net/addons/uclibc-basic.tar.bz2</a>
</pre>
</li>
<li>Extracting the archive:
<pre class="code">  
deb# tar xjvf uclibc-basic.tar.bz2
...
./uclibc-basic/uclibc-env/dev/&lt;device&gt;
tar: ./uclibc-basic/uclibc-env/dev/&lt;device&gt;: Cannot mknod: Operation not permitted
...
tar: Error exit delayed from previous errors
</pre>
We ended up with some <i>permition denied</i> errors. We need to have root rights in order to create <i>/dev</i> nodes (special files created with the <a href="http://linux.about.com/library/cmd/blcmdl1_mknod.htm">mknod</a> command). The problem is soved when we untar the archive as superuser:
<pre class="code">  
deb# sudo tar xjvf uclibc-basic.tar.bz2
Password: ...
</pre>
... now the extraction finished with no errors.
</li>
<li>Now we are ready to log-in to the newly created chroot-ed environment:
<pre class="code">  
deb# chroot uclibc-basic/uclibc-env/ /bin/su -
-bash: chroot: command not found
</pre>
We need superuser rights in order to use the <a href="http://en.wikipedia.org/wiki/Chroot">chroot</a> command: 
<pre class="code">  
deb# sudo chroot uclibc-basic/uclibc-env/ /bin/su -
Password: ...
dev#
</pre>
... so now we are sucessfully logged in the new environment.
</li>
</ol>
<i>Tip:</i>
<br/>
I am using <a href="http://puttycm.free.fr/">Putty connection manager</a> for accessing all the systems and I have found it very convenient. In 'PCM' it is possible to create a command sequence executed just after the login - so for the <b>dev#</b> login I just setup the following command sequence:
<pre class="code">  
deb# cd ~
deb# chroot uclibc-basic/uclibc-env/ /bin/su -
dev# export PATH=$PATH:/mnt/C/sys/bin
dev# export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/mnt/C/sys/lib:/mnt/C/sys/apache2/lib
</pre>
</span><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/183431720687819497-1620764148337404955?l=filodej.blogspot.com' alt='' /></div>
